# 一个简单的用“深度学习”进行文本分类的方法

# 1. 效果演示

## 1.1 输入

给定一个文本，判断属于给定类别中的哪一个。

如给定文本：

> 意媒曝皇马如购卡卡失败将攻伊布 惊人代价高达6700万	意媒曝皇马如购卡卡失败将攻伊布 惊人代价高达6700万　　新浪体育讯　周一的《米兰体育报》报道，皇马已经向国际米兰提出了用4000万欧元加斯内德交换伊布的请求。这份意大利体育报纸披露，弗罗伦蒂诺之所以想要引进伊布，是为了给可能的卡卡转会受挫备下替代方案。也就是说，如果皇马无法引进卡卡，那弗罗伦蒂诺将转向进攻伊布。

模型判断属于['体育', '时尚', '财经']中的哪一个。

## 1. 2 输出

样例很明显属于`体育`类。

# 2. 数据

使用THUCTC数据集（[http://thuctc.thunlp.org/](http://thuctc.thunlp.org/)），这是清华大学自然语言处理实验室推出的中文文本分类工具包附带的数据集。是一个包含了14个类别的新闻数据。

14个新闻类别如下：

```
> 体育   娱乐   家居   彩票   房产   教育   时尚   
> 时政   星座   游戏   社会   科技   股票   财经
```

一共包含836075篇文章，笔者按照4：1：1的比例随机切分得到了训练集、验证集与测试集。

# 3. 基于FastText的文本分类

Word2vec [1]的作者Mikolov基于word2vec提出的FastText [2]分类方法。整体上被一些学术界的人质疑创新性**不太够，但并不影响这是一个实用的、容易得到很好效果的文本分类方法，尤其是长文本分类。

FastText的主要贡献在于：

1. 表明即使是简单的基于词的embedding的平均值，也可以很好地表示整个文本，进而用于文本分类；
2. 使用n-gram进行特征提取，可以稍微弥补Bag-of-words所导致的文本词序缺失带来的信息损失。



与word2vec一样，使用CBOW或者skip-gram两种学习方式首先学习

<img src="fast_text.png"/>



# 4. 数据预处理

1. 将每篇新闻文本合并到一行，得到标签、标题与正文。

   > label \t title \t text

2. 对标题、正文进行中文分词，去除停用词。得到如下的数据：

   > 科技    中秋 国庆 黄金 双周 出游 三成 机票 网友 抢走    中秋 国庆 黄金 双周 出游 三成 机票 网友 抢走 中秋 国庆 放假 安排 密度 大 、 间隔 短 ， 称为 史上 最 零碎 长 假期 。 很多 人 避开 国庆 旅游 黄金
   > 周 ， 休假 出行 计划 提前 中秋 。 淘宝 旅行 平台 数据 显示 ， 机票 、 箱包 旅游 相关 产品 热 抢 阶段 ， 中秋 国庆 半个 月 ( 9 月 15 日 ~ 10 月 15 日 ) 机票 售出 三成 ， 北京 上海 、 深圳 热门 航线 售
   > 出 超过 50% 。 淘宝 仍 便宜 票在售 记者 调查 发现 ， 双 黄金周 期间 ， 航班 30% 机票 售出 ， 上海 、 北京 热门 航班 更是 票源 吃紧 。

3. 使用预训练的词向量 [3]，对每一篇文章，对于分词结果，查询词向量，计算平均值。简单起见，对标题与正文合并处理。得到

   > label \t 文本向量表示，300维向量，以逗号分隔。

   数据示例：

   > 科技    -0.015852956,0.111438766,-0.021455063,-0.0050904024,-0.30068386,0.0450483,-0.056035586,0.19103067,-0.05296858,0.031689357,0.016048187,-0.14343895,-0.07969891,-0.10407096,-0.026082741,0.13580397,0.014486666,0.13451266,-0.04794995,0.028937954,0.20230992,0.07742328,-0.09250792,-0.03761031

4. 

# 5. 模型训练

# 6. 模型测试

# 7. 实验结果



# 参考资料

[1] Mikolov T , Chen K , Corrado G , et al. Efficient Estimation of Word Representations in Vector Space[J]. Computer ence, 2013.(**word2vec**)

[2] Joulin A , Grave E , Bojanowski P , et al. Bag of Tricks for Efficient Text Classification[J]. 2016. (**FastText**)

[3] Shen Li, Zhe Zhao, Renfen Hu, Wensi Li, Tao Liu, Xiaoyong Du, [*Analogical Reasoning on Chinese Morphological and Semantic Relations*](https://arxiv.org/abs/1805.06504), accepted by ACL 2018. https://github.com/Embedding/Chinese-Word-Vectors